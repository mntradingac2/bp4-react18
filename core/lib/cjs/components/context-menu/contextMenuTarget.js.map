{"version":3,"file":"contextMenuTarget.js","sourceRoot":"","sources":["../../../../src/components/context-menu/contextMenuTarget.tsx"],"names":[],"mappings":";;;;AAgBA,qDAA+B;AAC/B,4DAAsC;AAGtC,gDAG6B;AAC7B,8CAAgE;AAChE,gEAA6D;AAC7D,mEAA6C;AAgB7C,SAAgB,iBAAiB,CAAsD,gBAAmB;IACtG,IAAI,CAAC,IAAA,kBAAU,EAAC,gBAAgB,CAAC,SAAS,CAAC,iBAAiB,CAAC,EAAE;QAC3D,OAAO,CAAC,IAAI,CAAC,6CAAoC,CAAC,CAAC;KACtD;IAED,OAAO,MAAM,sBAAuB,SAAQ,gBAAgB;QACjD,MAAM,CAAC,WAAW,GAAG,qBAAqB,IAAA,sBAAc,EAAC,gBAAgB,CAAC,GAAG,CAAC;QAE9E,MAAM;YACT,MAAM,OAAO,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC;YAE/B,IAAI,OAAO,IAAI,IAAI,EAAE;gBAEjB,OAAO,OAAO,CAAC;aAClB;YAED,IAAI,CAAC,KAAK,CAAC,cAAc,CAAM,OAAO,CAAC,EAAE;gBACrC,OAAO,CAAC,IAAI,CAAC,uDAA8C,CAAC,CAAC;gBAC7D,OAAO,OAAO,CAAC;aAClB;YACD,MAAM,gBAAgB,GAAG,OAAO,CAAC,KAAK,CAAC,aAAqD,CAAC;YAC7F,MAAM,aAAa,GAAG,CAAC,CAAgC,EAAE,EAAE;gBAEvD,IAAI,CAAC,CAAC,gBAAgB,EAAE;oBACpB,OAAO;iBACV;gBAED,IAAI,IAAA,kBAAU,EAAC,IAAI,CAAC,iBAAiB,CAAC,EAAE;oBACpC,MAAM,IAAI,GAAG,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;oBACvC,IAAI,IAAI,IAAI,IAAI,EAAE;wBAGd,MAAM,SAAS,GAAG,IAAA,yBAAW,EAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC;wBAC1D,CAAC,CAAC,cAAc,EAAE,CAAC;wBACnB,WAAW,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,IAAI,EAAE,CAAC,CAAC,OAAO,EAAE,GAAG,EAAE,CAAC,CAAC,OAAO,EAAE,EAAE,IAAI,CAAC,kBAAkB,EAAE,SAAS,CAAC,CAAC;qBACnG;iBACJ;gBAED,gBAAgB,EAAE,CAAC,CAAC,CAAC,CAAC;YAC1B,CAAC,CAAC;YAEF,OAAO,KAAK,CAAC,YAAY,CAAC,OAAO,EAAE,EAAE,aAAa,EAAE,CAAC,CAAC;QAC1D,CAAC;KACJ,CAAC;AACN,CAAC;AA5CD,8CA4CC","sourcesContent":["/*\n * Copyright 2016 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\n\nimport { IConstructor } from \"../../common/constructor\";\nimport {\n    CONTEXTMENU_WARN_DECORATOR_NEEDS_REACT_ELEMENT,\n    CONTEXTMENU_WARN_DECORATOR_NO_METHOD,\n} from \"../../common/errors\";\nimport { getDisplayName, isFunction } from \"../../common/utils\";\nimport { isDarkTheme } from \"../../common/utils/isDarkTheme\";\nimport * as ContextMenu from \"./contextMenu\";\n\nexport interface IContextMenuTargetComponent extends React.Component {\n    render(): React.ReactElement<any> | null | undefined;\n    renderContextMenu: (e: React.MouseEvent<HTMLElement>) => JSX.Element | undefined;\n    onContextMenuClose?: () => void;\n}\n\n/* eslint-disable deprecation/deprecation */\n\n/**\n * ContextMenuTarget decorator.\n *\n * @see https://blueprintjs.com/docs/#core/components/context-menu.decorator-usage\n * @deprecated use ContextMenu2\n */\nexport function ContextMenuTarget<T extends IConstructor<IContextMenuTargetComponent>>(WrappedComponent: T) {\n    if (!isFunction(WrappedComponent.prototype.renderContextMenu)) {\n        console.warn(CONTEXTMENU_WARN_DECORATOR_NO_METHOD);\n    }\n\n    return class ContextMenuTargetClass extends WrappedComponent {\n        public static displayName = `ContextMenuTarget(${getDisplayName(WrappedComponent)})`;\n\n        public render() {\n            const element = super.render();\n\n            if (element == null) {\n                // always return `element` in case caller is distinguishing between `null` and `undefined`\n                return element;\n            }\n\n            if (!React.isValidElement<any>(element)) {\n                console.warn(CONTEXTMENU_WARN_DECORATOR_NEEDS_REACT_ELEMENT);\n                return element;\n            }\n            const oldOnContextMenu = element.props.onContextMenu as React.MouseEventHandler<HTMLElement>;\n            const onContextMenu = (e: React.MouseEvent<HTMLElement>) => {\n                // support nested menus (inner menu target would have called preventDefault())\n                if (e.defaultPrevented) {\n                    return;\n                }\n\n                if (isFunction(this.renderContextMenu)) {\n                    const menu = this.renderContextMenu(e);\n                    if (menu != null) {\n                        // HACKHACK: see https://github.com/palantir/blueprint/issues/3979\n                        /* eslint-disable-next-line react/no-find-dom-node */\n                        const darkTheme = isDarkTheme(ReactDOM.findDOMNode(this));\n                        e.preventDefault();\n                        ContextMenu.show(menu, { left: e.clientX, top: e.clientY }, this.onContextMenuClose, darkTheme);\n                    }\n                }\n\n                oldOnContextMenu?.(e);\n            };\n\n            return React.cloneElement(element, { onContextMenu });\n        }\n    };\n}\n"]}